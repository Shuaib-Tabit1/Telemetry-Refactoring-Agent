{
  "basic_intent": {
    "issue_category": "INSTRUMENTATION",
    "static_analysis_query": {
      "find_method_call": "SetTag"
    },
    "semantic_description": "Add HTTP_REFERER and HTTP_RESPONSE_REDIRECT_LOCATION headers as attributes on existing HTTP request spans in the CLM web application.",
    "search_keywords": [
      "HTTP_REFERER",
      "HTTP_RESPONSE_REDIRECT_LOCATION",
      "SetTag",
      "AddTag",
      "ActivitySource",
      "OpenTelemetry",
      "redirect",
      "middleware"
    ],
    "telemetry_operation": {
      "type": "span",
      "target_name": "http.server",
      "action": "ADD_ATTRIBUTES",
      "attributes_to_add": [
        {
          "name": "HTTP_REFERER",
          "value_source": "request.header.Referer"
        },
        {
          "name": "HTTP_RESPONSE_REDIRECT_LOCATION",
          "value_source": "response.header.Location"
        }
      ],
      "new_span_name": null,
      "new_metric_details": {}
    }
  },
  "enhanced_analysis": {
    "confidence": "high",
    "operation_type": "multi_file",
    "complexity_score": 3,
    "estimated_files": 3,
    "validation_issues": [],
    "suggestions": [],
    "sub_tasks": [
      {
        "order": 1,
        "action": "direct_implementation",
        "description": "Simple single-step implementation"
      }
    ],
    "contextual_hints": [
      "Capturing Location header on redirect responses\u2014header is not available until after the middleware that issues the redirect runs, so enrichment must occur late in the pipeline or via OnStarting callback",
      "Ensuring span is still alive when the response header is read so SetTag actually applies"
    ]
  }
}