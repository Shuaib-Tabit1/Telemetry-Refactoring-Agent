{
  "basic_intent": {
    "issue_category": "INSTRUMENTATION",
    "static_analysis_query": {
      "find_method_call": "SetTag"
    },
    "semantic_description": "Add HTTP_REFERER and HTTP_RESPONSE_REDIRECT_LOCATION attributes to the existing HTTP server spans in the CLM web application.",
    "search_keywords": [
      "HTTP_REFERER",
      "HTTP_RESPONSE_REDIRECT_LOCATION",
      "SetTag",
      "ActivitySource",
      "AddTag"
    ],
    "telemetry_operation": {
      "type": "span",
      "target_name": "HTTP server span",
      "action": "ADD_ATTRIBUTES",
      "attributes_to_add": [
        {
          "name": "HTTP_REFERER",
          "value_source": "Request.Headers[\"Referer\"]"
        },
        {
          "name": "HTTP_RESPONSE_REDIRECT_LOCATION",
          "value_source": "Response.Headers[\"Location\"]"
        }
      ],
      "new_span_name": null,
      "new_metric_details": {}
    }
  },
  "enhanced_analysis": {
    "confidence": "high",
    "operation_type": "multi_file",
    "complexity_score": 5,
    "estimated_files": 3,
    "validation_issues": [],
    "suggestions": [],
    "sub_tasks": [],
    "contextual_hints": [
      "Hooking into the ASP.NET pipeline at the right stage to capture BOTH the incoming Referer header and the outgoing Location header for redirects",
      "Ensuring the redirect-location tag is only added for 3xx responses while avoiding double-tagging or missing async/await paths",
      "Validating that the new tags appear on the existing HTTP server span instead of creating a duplicate span"
    ]
  }
}