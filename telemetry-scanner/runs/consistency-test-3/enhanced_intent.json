{
  "basic_intent": {
    "issue_category": "INSTRUMENTATION",
    "static_analysis_query": {
      "find_method_call": "SetTag"
    },
    "semantic_description": "Add HTTP_REFERER and HTTP_RESPONSE_REDIRECT_LOCATION attributes to HTTP request spans in the CLM web application.",
    "search_keywords": [
      "HTTP_REFERER",
      "HTTP_RESPONSE_REDIRECT_LOCATION",
      "Activity.SetTag",
      "Request.Headers[\"Referer\"]",
      "Response.Headers[\"Location\"]",
      "ActivitySource",
      "OpenTelemetry"
    ],
    "telemetry_operation": {
      "type": "span",
      "target_name": null,
      "action": "ADD_ATTRIBUTES",
      "attributes_to_add": [
        {
          "name": "HTTP_REFERER",
          "value_source": "Request.Headers[\"Referer\"]"
        },
        {
          "name": "HTTP_RESPONSE_REDIRECT_LOCATION",
          "value_source": "Response.Headers[\"Location\"]"
        }
      ],
      "new_span_name": null,
      "new_metric_details": {}
    }
  },
  "enhanced_analysis": {
    "confidence": "high",
    "operation_type": "multi_file",
    "complexity_score": 3,
    "estimated_files": 2,
    "validation_issues": [],
    "suggestions": [],
    "sub_tasks": [
      {
        "order": 1,
        "action": "direct_implementation",
        "description": "Simple single-step implementation"
      }
    ],
    "contextual_hints": [
      "Finding the single place where the outbound redirect header can be read (needs to be after `next()` in middleware)",
      "Ensuring the added tags follow existing ActivitySource / OpenTelemetry conventions so they are not dropped by any processors or exporters"
    ]
  }
}